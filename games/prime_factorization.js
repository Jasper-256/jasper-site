document.addEventListener("DOMContentLoaded", function() {
    const urlParams = new URLSearchParams(window.location.search);
    let challengeNum = parseInt(urlParams.get("pfc")) || 1;
    if(challengeNum < 1) { challengeNum = 1; }
    loadChallenge(challengeNum);

    document.getElementById("form").addEventListener("submit", function(e) {
        e.preventDefault();
        clearTimeout(this.timeout);
        const userFactors = Array.from(document.querySelectorAll("input[name^='num_']")).map(input => {
            try {
                return BigInt(input.value);
            } catch (error) {
                return 0n;
            }
        });
        const infoTag = document.getElementById("info");
        const checkButton = document.getElementById("check");

        if(isCorrect(challengeNum, userFactors)) {
            infoTag.textContent = "You've entered the correct prime factors!";
            checkButton.textContent = "Next Challenge";
            checkButton.addEventListener("click", function() {
                window.location.href = "prime_factorization.html?pfc=" + (challengeNum + 1);
            });
        } else {
            infoTag.textContent = "Incorrect";
            this.timeout = setTimeout(function() {
                infoTag.textContent = "";
            }, 2000);
        }
    });
});

function getChallengeFactor(challengeNum) {
    const challenges = [6n, 15n, 209n, 47077n, 3832343173n, 17552345699985880033n, 256232121352508651574907120496388278077n, 72766680183024192465551369814503150458222546558848234704938355713516940651863n, 13262731672193470448780743325116019772665759576677515727776495411548264009269567519093017716292704006107273878603003884176732333443602033741369100389077969n, 177748032774801049585813473454166233071051448786439105050809775265897180903587657707756703802010134801630073272729474294819018958041341379185938040845501926277999444830108102681113086699429661248929923879796503681050387479856199883807402036809137931961857422522125145687912211390489700910809760655629875782613n, 27853985130884527188920007395369709212478543588035211721678129624710133748948565518242787734712291021992799539665918162230124316324532592961713819424804649218466443663210106084999495516077500459507001849813413017172383731332423377786398167703261685374368981471018293239382288997015707946159091908492739948680527341988536690577712163175557776290705087960256489442028809979847877996513811982578654414240491937753428758279340395047603574875554516722951916063357394582762928944721213564704794696101720095911383040385781288161389170711260046079066671934440820456115359922681867617127477000105407555311809721265171218831347n, 840533705296440987493635917854455446483747892955743692215022964768352551588927430108663931578629188208219815320069126400239612533320298343225013721395383873512077223524223660133043288848926029947885351918812610179051078362749737429646299597397035829784761354573972103740035426476791465726119509736363657142859325819104379791694345044520304845487638573913494224217302608980701012204742768605470238039990040595787694019617584395717195448986827519717139469662553026809651309888368881328910064143742927695887747765643980167546437671037760988682899798513663607258792586736898249552348974759373311166075181652965090729273877886339812133971022724324793308760777358650784438587866092180531421050872600803137383909110854312323544791054249551796167043061885453911424309592443309810849399556238024144586764604004559922063814693016627010213671003686148338004833668744055038757269639663032565481461281485700122773244924206514190263371970277856439823721145782325405899025622277134873069494944895246152148277875181385928247420684302017739427955652702528932016942961663304106745793089867104497279801821461547015330289785131197633268813049517834106702313339845358195673109167295865337634601892552033480889718771107243709196331636283829189159436107169n, 664951037631675723157192763896091500283767832216289769009280380439918504843958298240696502875474021180624053336155523693732291315240825540690213563337954794228011137505392694550813396580326928212768290559987503536435621814873170076169483529978275935290648480023441362163226080953151084053241546617687082569947904286062037603901581292230760765527272217650937958673745131923340409995207634482396528980207303482619932234889705832016553123218296491317659922000356343384026942882239991202205553423604188656127626690925307574308635829930796198673290934595238193023610943812768280636978477914718767304998788128632646976098801683293585376137109563726521961249978056674527083540074943483263013178846097179263070436277020412865816583303869887675524313668876342382593888443015515692014523338102735043207489203644266675645919662050600431565094685288834194408112742042981464040197170036706771898330434761379871201218198729894580999758448688482285076272141555012617312511558967973452639583956235207119447474740530654814547487213701664037572828696441858487852374061794610900390374270148589924423987959538211125272582263851908793924472326947345493890551296413920004157139779485749769118752587346958552937330207770749761188847087161314964853176482846979469309963562027942889295664035743402371854857163723233694943530889375885682688344633970132073516289024093208512137785649745274694256317673430971236364996492260908412284770997657810960986735824768516301416583710535416165050899747627079916469668959123841162148074200821083265053613929752069996500582438721823543874177571551848216328092330287271234686664102893250942936502277447116479514890247123854831115801931894478219484763129317014732931018083078501913945163985208089648415855158055426718082370956146405542973890067254573019346439777198585792460814718312200190067650451349685190827283544486698534665957283920526921971114798273615505429574256005257582991223306908554197600822391006036556260406045852762534234316771263648221301304299026789189286533300806317431502889445137201208812351003696335714799564784572281977005954683339558388924176731944730032370860777383568648030824041675709034277196199537942966560634741107102182138195527753508966825672648691153850645222416691375177488591001827889972936898265697398839405620640922113645021980086963621042327800220979387546969699174196810213928374751565357367366009562841111829581362481106181371953610277923263188658373635472976123058520770060005200836870950712448437989983789166374304109n, 1071044653353568200400435217472746163745490246178385361413034605330251157614898053740844944031658771110238642852341057902939034439479707097538692907441980641396955837414946606632318744860151967428713960614506179201233971467619878625514874897517736883670994385196505807913273669249015014725706910780648106364294073108068387261448081463608606068963516795112737557940565697650324418320622723541031089057083773655731231549141443844692705591398814354916997362690055151271322757275125984523384589827314085474460382834996291182501259003229998310795526288319755690096177748935704738770968696293207610595023149539995440034274885277794716387553301526782735783420155802648287717801665003989789421137777607108149487742618173449257630756472067067221866925075331696020507343277590194637112119933051843350252290717465208186145815508587245258021183714341302850293323196077251075733043759487863513442064373978398678561620379664175990259662292353555082242704550840296079818991107287288584059558970423398669525685206895669244610002946515508438107359467082386695479843735607011914408550167603109732279653750817286911152790095109229459101404142217011209968700586909950088123036428580662816772059637267363967185693534505508233311738363793577330309203958333485951786842876169790974046333364007309537155955042935019279449835417197172837099681080822376430400557550443624418712804842351855256947464023469507621845728212907719455045503369239594767709094899363986785494688266194972699208070919277734135794487034812676233113922280459806907802927957464456326713824052886828112418371654173283949627286328772019341403295798089540320917794595398351056273242322941889665423267601543859049997646691705032374654248565149327812011502600258159276398481603650087528296870276779689000314352441306752974482717713186118837838117525894363767563389242436427676078498261549108868793100729889801778821151579044484114160414216891911823933821359062461132072305496144836833433578499396423700751387255453484524214429191285412554050341176155278413104568626487910417781685268821453122348000877872942528279054009638879609326415570837785010533618792622721577110613320887823227419857603973855927248799307319830436953060509170993268633597207126057308759722139881267987663142457284393429460995267514782721244610060472651283358597037086665972870010989681069726172659839084670028584453254175579746022879820522033042807548297576817584005966311813330040535113780669920866677774381278676012379818159669260709302364356193163909337500221302662218423261928487760426160074383858537062961613878621957652082249576617804835573190856825244785522077335538347523232663261911595044732056122021976049781182387073476555629318090163470043638383891780982435348838255916860738701963922127767421688326068563168499220185817608618909943644246495791326025934038456457578798905378754954414204589942565537376222446436313871823240109201794280562791620296937815553792062411855064860455569449469058253147734045109998968095960601878299848376642932407110625231491263479905148280727072973509169136529760983669817894001007419606736889378733672363067656306926449845311622477189776854503760099156259183058990618212293097181408159463152052092901853226107670922807462712239966995536589569251568446406028346408159698782428070179197857402793848933062448755566740735851993904789597446947618579785125235771838499283180440737821167572185979102119641197065767734600072546605792314719681186742951746146562672767849662972408528914424572298050979515510012293297620291273275214321312089668797017763805710090764364318091242889523020067967816738561318853153922044352875048619463138154114136842901016105199061348661217947899905426522913304201579372529447631408577591033270541433450220528994186122572685922096181734517343782943767491766925285179120478934592409899544340305956073590222306694279250579036381471231157617235933505856068746135123528826026646391056263549117420128134327194927192193360850367710791753092416114290210495338086303719235140953427139218675783056725151507077831024378824339308735634745189528253379140316741250563383660366855370081172488792002434296468688006849691804057291002553691852244034610916300070309003816549904699231115621064993651358238328737730703578792750742873231651295340184753829480793285135550240148040549875397739259286115768461988352295981971424289970695317083891641362068055331106174356329691195474825048842485299567038642318180607512806149368759983323084348139034973261458886740908920992116995678246311518595094085948192138057665382743985760056946462127653732927528070940965330102437343059124496143606265703153700542407646346273581248488500158268937169804331732162993055818767570641528386822797063343691770486008338102864789474511825754457371151755264192434206614491639251599309184403665567451302313526774852104614163106308373437888705743398197722879845950131062852021290061789482577876697674440304086590229056410752621779681418390330059657201826200084557990943705233613211112444138652493552987614881973n, 1248677509542418783812158954880506236833129880967764922535661303613618582500257376782423098479310943604053866079413861839263111846627005200018390194551809602288191078610703857905744797567991934907987393616957115018377675011624602808196407928048441552887259745835139685147151634001466931866906484294824519586543229023373569758253525651727452118500927183868939031733000320297766432778394758501703762843873597618614573772338540159338675537073069865598973160168402015423909659657562873134667708929429626022236667407074842428211217793831031503438883004872746924719485127413498032990801745462093435424059622592758296995711587340666218484289810277560107574744630298975377445577387568262772804848990425236479249440239979333647273257133883099939436876939120789726943607080165165301263419543287104332436243930555216966983619683059139522964052425340891656927996702569448670689653664274174757020501582198916007135162362233865267466220351803878989600132052581262057375065424924889227680406170087481371830459235982277229924621431390533641346307866406430350154166590271914143853761522439242552481515481957505669198405076659892883715331993906862785397814429817768344151676379961790786985013375730511341950825243072478023792869327827128517816204595017412990425909396332533291210108144984393062516130913591802786164366316415593524127137121962309083906262845934999207939768730795353573992053375092362743905271049959029066650421542284333307906325054530678676128139953017010370154268772689536674938932199479149178645775403060329427340874270304379244489837834179702930935577676667263273540771656637924833504213466244601601064092049802558552611769702059124712341691108794423247223119313541404099824657403126601062402864500077810947395759314357436334541733695117440074473500941608038518100746921064265558525495488968089708353830831559068478504651136782312508318282105192792139859724901628764851520036414184640023294945299779171409952899375449805464636145577748785001160888579664398938918064767281704097927352514409941382094123884899237320247972872518996783116175113064390556711058179783227436919029066546354130845938418382971988810163441162637640044480853382507439769242277457824467205703142941160200778413987463109918765274178122402963791517560162024809681573465354253199339214459637824370053369384646505266038879556128477785094444308746758405938224754576712251145959918374046449470114247165518056538691929064575573385114703238170988289821513541462070882366028805196392196681519505934910550733532335590303980209025816440812546425901219322285099176181489941607826814971810159934709386889801425730501988290835213827919914440558725586577656548923473310094584170718787845288304412789697411876932597718849092716856274180937062984902022952157520290626364959590630409299808204210469405822422389546814548717168023287091462177259467312668550301460199865869966008248172876077692856522240250474276057415045019831264999155580933563003202087456924129320585624909390467746552052988896593664186989283107538464461132231109953774503052999232506629858839731405356054220118260567343321433566818147232314488336307470712839151226121128611250354984656531021843103981397820699564382409565536695063202606854198336386130829971522765315244602742607722421488368873283152486110177470505717210423196894372717618334750795666087186161479077536770657215744784642888418935455733332785747894084113731048620227139067985744435562565067209033404256120876714874879502616917683575823940554328050979659520206589848569268617723679683048357325534048821706500409403553815835183364704685427532802068111572772818528340327038432960585199615665382769570541817063040000920014258314035714640337730120455086144073425377751331176834391351817851863983055003875159554854062713602032699322574240777145572617742919738614074301890339948728949762969024331269904943934786580208167282838480829734746129517667892608819212714124459434566509186419379291693601462175140990207546263309101759693869500652178450767984082266363486553717656708446926859172072114797795739438774478655828329247653899904595073406979696463060404695438782244143360923101847251491598905238662151554932858936880331714652826995688717284228071401952916478789876701620047953318078621233346937064764623928398161524632292729330180850714011465539616761307479569117723530486617372621917416874678117457653089860862848068628406177471186642048247123642868673100782763130498477179204569707929015022959245439507981344388838031928345786229181555230977432826274531590807531215183213194414298892171430074214615174626731724642716599872482010821226692911894348103599312616683371126013758421063986805390426542226154275375516440489080375103883389918673464320146966773173285368546550003056293392183541543829458532200250634554685527625973213988222955187519536884893162890376636110452226742537060179969650247551145731375226635500718087850329694465841618047167779847815914798001837199864974707694201810750251742274719065307721637122024468154765682049455285449542107287613879335445237941084170797544124067052133888452803514559486162186126898107984222330089181147203039457177330725292980059118278042905659621339536014323179639312543378949184239943665027575579684650908549090937990901499999061172055762860871290944188370111427654005437567931252482307223762410918322759569900571868159597832483321611327410070843636797156823220454241554399769258131009086924453080213250705542909350098204651778677405970863609871907212546312699596221970441561594932313676250852998920663629893549053659351184717875941144517062931915173901468358562519765531216425128483137647174263783139899171061342892029825995367109092967951120029625478399192760078925397839458124484852270788374014261181628472771399030866632005132021135894377616777267946082776737256895406683024702280753661700924950272762591013065161883522408326424931727362245996600675193052169508767631799314838937146588810382780429688796552147023001839423592143396487919061426023065442123495501758392018938236667283312880918087605729064954362794904157731349264474433867361304239432041462297444836743915060637410853718178470834909972035414502869529293763956128926135957944498543451798826645771489489579675914272365508372986324528908174302948003130027130210031783266542029866114451226185685417717674349720695725133297019216513895768917972368208851622006177814431333342940188856503871090746176638655336245099558416458099144177194442413707057812892821298681713611066118559725711264160132584889459625744144342714996543656109813405046654415863071129540801275017049394602485728599730820700487511948301308182178635232240045265533958393189718299783833309553763907943375987721797427428485496034833006468385549961133288241511193477898063489011049258079747133980650147411655558056575035014486386948138585414917967361005317986557112792440936513576043137358392785550003025152462613716018405506048896936381003820313063794446023291102655714631578522209854637881697412976272111012296850728621925774851764031618761923985736794023427834265249936499055033086070343561009965735061232709778807642425320144109229152007825693956451956773697321008697140012795448270573393611452054046995154667129196878676699966313179236949681181897566906029436514822824638937165350224414981795614494651462776555149790333323202757815632850400294678447255182840010444401485723295576671138949757863139179687250116756399795854225158133415085835704869590560526472698971259432091952803398047709117125956231963298054554962391616861455190199773960409241068823533877312279582453755773664610620512057075156279852827439278348644245942403057248186850012831891883750846051190532314276066564098460936489176185535782891192109340783622792968592877132751789158311891399027491544114819467392212086313802761461689423540775965712231872349476429515433989385863748401032366746486389705262413371984735536772813638542446852210238589774183119330670009502595089277926508785246729702698750610039123193717053631567603389045301483677842604895588040818474573330025183973004015196141650777870550823816844367685279382912004658364897864288734434288398239168366916339395586242853753650095132988463106371718220927771366061296862097668025478496180932475779534237058911914210266438409861474375290841529449721646285698581435819217925792659505298067843120996058702158016139851733114049093020604826736105796162912478556212797086636280970838232226164322546796966155836278725145681972134132373593621265278901471951173226917612893287781688766359364663316689411606274924594175335335502813165546368374829787283655228666339728134268438071308330333010003288664390219779896982101234521778761354669628572763695834227095663267395774033563043129988943288643381269745086134564834528357933468757028136822787849569486390052704879081801479094311323441987653176403045121203594157759886865784282747826941655639139587336587628885753351665094977108786871590967960021828636694945091732463005962866271203026352081589999008673203483666093763324837233818878314608665784157001773992569072983530191007644678232517512038632386243259710943385941237389305088084771039929670502734981158808372690231169730610370040447974345707693451356079008748309389810223022975265107358171956012121546395516490330264285478632348235889045199649840651078609907175587714670168388593764415770479658937877719913847730539133735819889176869088104995220714876988345817120836965062391980590281723354012501781400981820077528843614486850208845616999741674709010456085683005969808791186718492130029920262279340006693984368991195860315620305369444958615637278615085216965464944332906154971111886901362396569434374319509570267136633992542603932760474131471296330306973875036461085019041346326759496933672849261444830942172243204873476534166871879711765071940689374589494322243467985226610303217397308665399851806564489698806286174878832680324275686699332427516231060115761612466567564567904524532791424716055229875417573703754246518762202179315966381990813678430878789901311005743200640716968750365194001919323949n];
    return challenges[challengeNum - 1] || 0n;
}

function isCorrect(challengeNum, userFactors) {
    const factor = getChallengeFactor(challengeNum);
    var product = 1n;
    for(i in userFactors) {
        const userFactor = userFactors[i];
        if(userFactor === factor || userFactor <= 1n) {
            return false;
        } else {
            product *= userFactor;
        }
    }
    return factor === product;
}

function loadChallenge(challengeNum) {
    const zeroPad = (num, places) => String(num).padStart(places, '0')
    document.getElementById("challenge_num").textContent = zeroPad(challengeNum, 2);
    document.title = "PFC-" + zeroPad(challengeNum, 2) + " - Jasper's Site"
    document.getElementById("factor_text").textContent = getChallengeFactor(challengeNum) == 0n ? "Congratulations on completing all of the challenges, unless you skipped ahead" : "Find the prime factors of " + getChallengeFactor(challengeNum);
}
